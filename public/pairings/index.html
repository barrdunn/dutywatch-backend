<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Pairings for Barry Dunn</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer">
  <link rel="stylesheet" href="/pairings/pairings.css?v=36">
  <style>
    .hidden{display:none!important}
    body{min-width:340px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:0px;gap:12px">
        <div style="display:flex;align-items:center;gap:12px;flex-wrap:wrap;flex:1">
          <h1 style="margin:0">Pairings for Barry Dunn</h1>
          <span class="chip" id="looking-chip">From <strong id="looking-through">—</strong></span>
        </div>
        <button id="settings-btn" class="icon-btn" title="Settings" style="flex-shrink:0">
          <i class="fa-solid fa-gear"></i>
        </button>
      </div>

      <div class="sub" id="status-line" style="margin:2px 0 8px">
        <span class="chip" id="hidden-chip">
          <span id="hidden-count">Hidden: 0</span>
          <a href="#" data-unhide-all style="color:var(--accent);text-decoration:none;margin-left:6px">Unhide all</a>
        </span>
      </div>

      <div class="controls" style="margin-top:8px">
        <form onsubmit="window.dwManualRefresh(); return false;" style="display:flex;gap:12px;align-items:center;flex-wrap:wrap">
          <button class="btn" type="submit">Refresh</button>
          <span class="chip">Last: <strong id="last-pull">—</strong></span>
        </form>
      </div>

      <table id="pairings">
        <thead>
          <tr>
            <th class="ckhdr" aria-label="Check In"><span aria-hidden="true">✓</span></th>
            <th>Pairing</th>
            <th>Report</th>
            <th>Release</th>
          </tr>
        </thead>
        <tbody id="pairings-body"><!-- filled by JS --></tbody>
      </table>
    </div>
  </div>

  <!-- Settings Modal -->
  <div id="settings-modal" class="modal hidden">
    <div class="modal-card" style="max-width:480px">
      <div class="modal-header">
        <h2>Settings</h2>
        <button class="modal-close" id="settings-close">×</button>
      </div>
      <div class="modal-content">
        <div style="display:flex;flex-direction:column;gap:16px">
          <label class="setting-row">
            <span>Auto-refresh:</span>
            <select id="refresh-mins" class="toggle">
              <option value="1">1 min</option>
              <option value="5">5 mins</option>
              <option value="10">10 mins</option>
              <option value="15">15 mins</option>
              <option value="30" selected>30 mins</option>
            </select>
          </label>
          <label class="setting-row">
            <span>Clock:</span>
            <select id="clock-mode" class="toggle">
              <option value="12" selected>12h</option>
              <option value="24">24h</option>
            </select>
          </label>
        </div>
      </div>
    </div>
  </div>

  <!-- Plan Modal (Notification Attempts) -->
  <div id="plan-modal" class="modal hidden">
    <div class="modal-card">
      <div class="modal-header">
        <h2>Notification Plan</h2>
        <button class="modal-close" id="plan-close-1">×</button>
      </div>
      <div class="modal-content">
        <p class="plan-meta" id="plan-meta">Loading...</p>
        <table class="plan-table">
          <thead>
            <tr>
              <th>When</th>
              <th>Type</th>
              <th>Details</th>
            </tr>
          </thead>
          <tbody id="plan-rows">
            <!-- filled by JS -->
          </tbody>
        </table>
      </div>
      <div class="modal-footer">
        <button class="btn" id="plan-close-2">Close</button>
      </div>
    </div>
  </div>

  <script id="dw-boot" type="application/json">{
    "clockMode": "12",
    "onlyReports": false,
    "tz": "CT",
    "refreshMinutes": 30,
    "apiBase": "",
    "baseAirport": "DFW"
  }</script>

  <script src="/pairings/pairings.js?v=36" defer></script>
  <script>
    // Add click-outside-to-close for plan modal
    document.addEventListener('DOMContentLoaded', function() {
      const planModal = document.getElementById('plan-modal');
      if (planModal) {
        planModal.addEventListener('click', function(e) {
          if (e.target === planModal) {
            planModal.classList.add('hidden');
            document.body.classList.remove('modal-open');
          }
        });
      }
    });
  </script>
</body>
</html>